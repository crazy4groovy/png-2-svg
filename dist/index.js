"use strict";const fs=require("fs"),PNGReader=require("png.js"),JPEGReader=require("jpeg-js"),ImageTracer=require("imagetracerjs"),SVGO=require("svgo"),svgo=new SVGO({plugins:require("./svgo-plugins")}),toSvg=ImageTracer.imagedataToSVG;async function getImgData(e){const r=fs.readFileSync(e);if(e.endsWith("png")){const e=new PNGReader(r),s=await new Promise((r,s)=>{e.parse((e,a)=>{e?s(e):r(a)})});return{height:s.height,width:s.width,data:s.pixels}}return JPEGReader.decode(r)}async function svgThumbnailer(e,{colors:r=4,scale:s=2}={}){const a=await getImgData(e),t=Math.ceil(128/r**2)+1,i={scale:s,ltres:t,qtres:t,colorquantcycles:r,numberofcolors:r};return svgo.optimize(toSvg(a,i))}module.exports=svgThumbnailer;
